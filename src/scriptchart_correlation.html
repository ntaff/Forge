<!DOCTYPE HTML>
<meta charset="UTF-8">
<html>
<head>

<script src="https://code.highcharts.com/highcharts.js"></script>
<script src="https://code.highcharts.com/modules/data.js"></script>
<script src="https://code.highcharts.com/modules/drilldown.js"></script>
<script src="https://canvasjs.com/assets/script/jquery-1.11.1.min.js"></script>

<script>
window.onload = function() {

var dataPoints = [];
var valueEtats = [];
var nomEtats = [];

var fastFood = [];
var fastFood2 = [];


function addData2(data){
  for (var i = 0; i < data.length; i++) {
      dataPoints.push({
        x: data[i].etat,
        y: data[i].value
      });
  }
}

function addData(data) {
  for (var i = 0; i < data.length; i++) {
    fastFood.push({
      x: data[i].etat,
      y: data[i].quantite
    });
  }





  //convertir array of object to Array of arrays
  var output = fastFood.map(function(obj) {
    return Object.keys(obj).sort().map(function(key) { 
      return obj[key];
    });
  });



  var output2 = dataPoints.map(function(obj) {
    return Object.keys(obj).sort().map(function(key) { 
      return obj[key];
    });
  });




  //recupérer valeurs des états
  for (var j = 0; j < output.length; j++) {
    fastFood2.push(output[j])
  };

  for (var k = 0; k < output2.length; k++) {
    valueEtats.push(output2[k][1])
    nomEtats.push(output2[k][0])
  };


     console.log(fastFood2)

// Create the chart
Highcharts.chart('container', {
  chart: {
    type: 'column'
  },
  title: {
    text: "Corrélation entre le nombre de fast food et le taux d'obésité par états"
  },
  // subtitle: {
  //   text: 'Source: <a href="http://en.wikipedia.org/wiki/List_of_cities_proper_by_population">Wikipedia</a>'
  // },
  xAxis: {
    type: 'category',
    labels: {
      rotation: -45,
      style: {
        fontSize: '13px',
        fontFamily: 'Verdana, sans-serif'
      }
    }
  },
  yAxis: [{
    min: 0,
    title: {
      text: 'Nombre de fast food'
    }
    },{
        lineWidth: 1,
        opposite: true,
        title: {
            text: 'Taux obésite en %'
        }
  }],
  legend: {
    enabled: false
  },
  tooltip: {
    pointFormat: 'Nombre de fast food: <b>{point.y}</b>'
  },


  series: [{
    name: 'Population',
    data: fastFood2,
    dataLabels: {
      enabled: true,
      rotation: -90,
      color: '#FFFFFF',
      align: 'right',
      format: '{point.y}', // one decimal
      y: 10, // 10 pixels down from the top
      style: {
        fontSize: '13px',
        fontFamily: 'Verdana, sans-serif'
      }
    }
  }]
});

}




$.ajaxSetup({
    scriptCharset: "utf-8",
    contentType: "application/json; charset=utf-8"
});

$.getJSON("https://api.myjson.com/bins/om3qw", addData);
$.getJSON("https://api.jsonbin.io/b/5ca4ceb924f5074645eba53f", addData2);

}

</script>


</head>
<body>
<div id="container" style="min-width: 310px; height: 400px; margin: 0 auto"></div>
</body>
</html>



